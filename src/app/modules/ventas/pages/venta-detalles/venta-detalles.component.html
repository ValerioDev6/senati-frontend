<nz-spin [nzSpinning]="loading">
	<div class="min-h-screen bg-gray-50 py-4">
		<div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md p-6">
			<!-- Header -->
			<div class="flex justify-between items-start mb-6 border-b pb-4">
				<div>
					<h1 class="text-2xl font-bold text-gray-800">ICASE'S STORE</h1>
					<p class="text-xs text-gray-500 mt-1">RUC: 20609585146</p>
				</div>
			</div>

			<!-- Detalles de Venta -->
			<div class="grid grid-cols-2 gap-6 mb-6">
				<div class="space-y-3">
					<div>
						<p class="text-xs font-medium text-gray-500">DOCUMENTO DE VENTA</p>
						<p class="text-sm font-semibold mt-0.5">{{ venta?.numero_documento }}</p>
					</div>
					<div>
						<p class="text-xs font-medium text-gray-500">FECHA DE VENTA</p>
						<p class="text-sm mt-0.5">{{ venta?.fecha_venta | date: 'dd/MM/yyyy HH:mm' }}</p>
					</div>
					<div>
						<p class="text-xs font-medium text-gray-500">MÉTODO DE PAGO</p>
						<p class="text-sm mt-0.5">{{ venta?.metodo_pago }}</p>
					</div>
				</div>

				<div class="space-y-3">
					<div>
						<p class="text-xs font-medium text-gray-500">CLIENTE</p>
						<p class="text-sm font-semibold mt-0.5">{{ venta?.cliente?.nombre }}</p>
					</div>

					<div>
						<p class="text-xs font-medium text-gray-500">PERSONAL</p>
						<p class="text-sm font-semibold mt-0.5">{{ venta?.personal?.nombre }}</p>
						<p class="text-xs text-gray-600">{{ venta?.personal?.rol }}</p>
						<p class="text-xs text-gray-600">{{ venta?.personal?.email }}</p>
					</div>
				</div>
			</div>

			<!-- Tabla de Productos -->
			<div class="mt-6">
				<h2 class="text-base font-semibold mb-3">Detalle de Productos</h2>
				<div class="overflow-x-auto rounded border">
					<table class="w-full">
						<thead>
							<tr class="bg-gray-50">
								<th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Código</th>
								<th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Producto</th>
								<th class="px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase">Cantidad</th>
								<th class="px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase">P. Unit</th>
								<th class="px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase">Subtotal</th>
							</tr>
						</thead>
						<tbody class="divide-y">
							<tr *ngFor="let detalle of venta?.detalles" class="hover:bg-gray-50">
								<td class="px-3 py-2 text-xs">{{ detalle.producto.codigo }}</td>
								<td class="px-3 py-2 text-xs">{{ detalle.producto.nombre }}</td>
								<td class="px-3 py-2 text-xs text-right">{{ detalle.cantidad }}</td>
								<td class="px-3 py-2 text-xs text-right">S/ {{ detalle.precio_unitario }}</td>
								<td class="px-3 py-2 text-xs text-right">S/ {{ detalle.subtotal }}</td>
							</tr>
						</tbody>
					</table>
				</div>

				<!-- Resumen de Totales -->
				<div class="mt-4 flex justify-end">
					<div class="w-64 space-y-2">
						<div class="flex justify-between text-xs">
							<span class="text-gray-600">Subtotal</span>
							<span class="font-medium">S/ {{ venta?.subtotal }}</span>
						</div>
						<div class="flex justify-between text-xs">
							<span class="text-gray-600">IGV (18%)</span>
							<span class="font-medium">S/ {{ venta?.impuesto }}</span>
						</div>
						<div class="flex justify-between text-sm font-bold pt-2 border-t">
							<span>Total</span>
							<span>S/ {{ venta?.precio_total }}</span>
						</div>
					</div>
				</div>

				<!-- Botones de Acción -->
				<div class="mt-6 flex justify-end space-x-3">
					<button
						routerLink="./ventas/lista-venta"
						class="px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50"
					>
						Volver
					</button>
					<button
						(click)="printVenta()"
						class="px-3 py-1.5 text-xs font-medium text-white bg-blue-600 rounded hover:bg-blue-700 flex items-center"
					>
						<span nz-icon nzType="printer" nzTheme="outline" class="mr-1"></span>
						Imprimir
					</button>
				</div>
			</div>
		</div>
	</div>
</nz-spin>
